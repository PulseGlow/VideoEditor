<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- 按钮 -->
    <Style TargetType="Button">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.ButtonForeground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="10,6"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          RecognizesAccessKey="True"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{DynamicResource Brush.ButtonHoverBackground}"/>
                            <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{DynamicResource Brush.ButtonPressedBackground}"/>
                            <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.55"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- 按钮变体 -->
    <!-- 主要按钮样式 - 使用强调色背景，深色文字（在暗色主题下使用暗色文字以确保对比度） -->
    <Style x:Key="ButtonPrimaryStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.AccentPrimary}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- 次要按钮样式 - 使用默认按钮样式 -->
    <Style x:Key="ButtonSecondaryStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.ButtonForeground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- 信息按钮 - 使用深色文字以确保在亮色背景上的可读性 -->
    <Style x:Key="ButtonInfoStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonInfo}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonInfo}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- 成功按钮 - 使用深色文字 -->
    <Style x:Key="ButtonSuccessStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonSuccess}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonSuccess}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- 警告按钮 - 使用深色文字 -->
    <Style x:Key="ButtonWarningStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonWarning}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonWarning}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- 危险按钮 - 使用深色文字 -->
    <Style x:Key="ButtonDangerStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonDanger}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonDanger}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- 紫色按钮 - 使用深色文字 -->
    <Style x:Key="ButtonPurpleStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonPurple}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonPurple}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- 橙色按钮 - 使用深色文字 -->
    <Style x:Key="ButtonOrangeStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonOrange}"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonOrange}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- Outline 按钮样式 - 在亮色主题下使用暗色文字，在暗色主题下使用亮色文字 -->
    <Style x:Key="ButtonInfoOutlineStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonLightBlue}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <Style x:Key="ButtonWarningOutlineStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonLightOrange}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonWarning}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <Style x:Key="ButtonDangerOutlineStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Background" Value="{DynamicResource Brush.ButtonLightRed}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ButtonDanger}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- 输入 -->
    <Style TargetType="TextBox">
        <Setter Property="Background" Value="{DynamicResource Brush.InputBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.InputForeground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.InputBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="6,4"/>
        <Setter Property="CaretBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
        <Style.Triggers>
            <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="PasswordBox">
        <Setter Property="Background" Value="{DynamicResource Brush.InputBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.InputForeground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.InputBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="6,4"/>
        <Style.Triggers>
            <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="ComboBox">
        <Setter Property="Background" Value="{DynamicResource Brush.InputBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.InputForeground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.InputBorder}"/>
        <Setter Property="Padding" Value="4,2"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="IsTextSearchEnabled" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="0"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="Border"
                                Grid.ColumnSpan="3"
                                Background="{DynamicResource Brush.InputBackground}"
                                BorderBrush="{DynamicResource Brush.InputBorder}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="0"/>
                        <ContentPresenter x:Name="ContentSite"
                                        IsHitTestVisible="False"
                                        Content="{TemplateBinding SelectionBoxItem}"
                                        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                        ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                        Margin="3,3,23,3"
                                        VerticalAlignment="Stretch"
                                        HorizontalAlignment="Left"/>
                        <TextBox x:Name="PART_EditableTextBox"
                                Style="{x:Null}"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Bottom"
                                Margin="3,3,23,3"
                                Focusable="True"
                                Background="Transparent"
                                Visibility="Hidden"
                                IsReadOnly="{TemplateBinding IsReadOnly}"/>
                        <ToggleButton x:Name="ToggleButton"
                                      Grid.Column="2"
                                      Focusable="False"
                                      IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"
                                      ClickMode="Press"
                                      Background="Transparent"
                                      BorderBrush="Transparent"
                                      BorderThickness="0">
                            <ToggleButton.Template>
                                <ControlTemplate TargetType="ToggleButton">
                                    <Border Background="{TemplateBinding Background}" 
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}">
                                        <Path x:Name="Arrow" 
                                              Fill="{DynamicResource Brush.TextSecondary}"
                                              HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Data="M 0 0 L 4 4 L 8 0 Z"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Arrow" Property="Fill" Value="{DynamicResource Brush.TextPrimary}"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="Arrow" Property="Fill" Value="{DynamicResource Brush.AccentPrimary}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ToggleButton.Template>
                        </ToggleButton>
                        <Popup x:Name="Popup"
                              Placement="Bottom"
                              PlacementTarget="{Binding ElementName=Border}"
                              AllowsTransparency="True"
                              Focusable="False"
                              PopupAnimation="Slide"
                              StaysOpen="False">
                            <Border x:Name="DropDownBorder"
                                    Background="{DynamicResource Brush.MenuBackground}"
                                    BorderBrush="{DynamicResource Brush.MenuBorder}"
                                    BorderThickness="1"
                                    MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                    MinWidth="{Binding ActualWidth, ElementName=Border}">
                                <ScrollViewer x:Name="DropDownScrollViewer"
                                            Background="{DynamicResource Brush.MenuBackground}"
                                            Margin="4,6,4,6"
                                            SnapsToDevicePixels="True"
                                            CanContentScroll="False">
                                    <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained"/>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEditable" Value="True">
                            <Setter Property="IsTabStop" Value="False"/>
                            <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                        </Trigger>
                        <Trigger Property="IsKeyboardFocused" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.InputBackground}"/>
                            <Setter TargetName="Border" Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
                        </Trigger>
                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter TargetName="Popup" Property="IsOpen" Value="True"/>
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.InputBackground}"/>
                            <Setter TargetName="Border" Property="BorderBrush" Value="{DynamicResource Brush.InputBorder}"/>
                        </Trigger>
                        <Trigger Property="IsDropDownOpen" Value="False">
                            <Setter TargetName="Popup" Property="IsOpen" Value="False"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="ComboBoxItem">
        <Setter Property="Background" Value="{DynamicResource Brush.MenuBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="Padding" Value="8,4"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBoxItem">
                    <Border x:Name="Border"
                            Background="{DynamicResource Brush.MenuBackground}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            IsHitTestVisible="True">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.MenuItemHover}"/>
                            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.MenuItemPressed}"/>
                            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.MenuItemHover}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            </Trigger>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.MenuItemPressed}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- ComboBox下拉列表容器 -->
    <!-- 注意：Popup没有Background属性，背景颜色在ComboBox模板的Border中设置 -->

    <!-- ComboBox下拉列表边框和滚动视图 -->
    <Style TargetType="Border" x:Key="ComboBoxDropDownBorder">
        <Setter Property="Background" Value="{DynamicResource Brush.MenuBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.MenuBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- ComboBox下拉列表的ScrollViewer -->
    <Style TargetType="ScrollViewer" x:Key="ComboBoxScrollViewer">
        <Setter Property="Background" Value="{DynamicResource Brush.MenuBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.MenuBorder}"/>
    </Style>

    <!-- 进度条 -->
    <Style TargetType="ProgressBar">
        <Setter Property="Foreground" Value="{DynamicResource Brush.ProgressForeground}"/>
        <Setter Property="Background" Value="{DynamicResource Brush.ProgressBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.ProgressBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Height" Value="18"/>
    </Style>

    <!-- 滑块 -->
    <Style TargetType="Slider">
        <Setter Property="Foreground" Value="{DynamicResource Brush.SliderFill}"/>
        <Setter Property="Background" Value="{DynamicResource Brush.SliderTrack}"/>
    </Style>

    <!-- 菜单（顶部菜单栏） -->
    <Style TargetType="Menu">
        <Setter Property="Padding" Value="0,2"/>
    </Style>

    <!-- 菜单项（下拉/右键） -->
    <Style TargetType="MenuItem">
        <Style.Resources>
            <!-- 子菜单/上下文菜单模板 -->
            <ControlTemplate x:Key="MenuItemDefaultTemplate" TargetType="MenuItem">
                <Grid>
                    <Border x:Name="Border"
                            Background="{DynamicResource Brush.MenuBackground}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition SharedSizeGroup="MenuItemIconColumnGroup" Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup"/>
                                <ColumnDefinition x:Name="ArrowColumn" Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ContentPresenter x:Name="Icon"
                                              ContentSource="Icon"
                                              Margin="0,0,6,0"
                                              VerticalAlignment="Center"
                                              SnapsToDevicePixels="True"/>
                            <ContentPresenter ContentSource="Header"
                                              Margin="{TemplateBinding Padding}"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="True"/>
                            <ContentPresenter x:Name="IGT"
                                              Grid.Column="2"
                                              ContentSource="InputGestureText"
                                              Margin="30,0,0,0"
                                              VerticalAlignment="Center"
                                              SnapsToDevicePixels="True"/>
                            <TextBlock x:Name="ArrowPanel"
                                       Grid.Column="3"
                                       Text="->"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource Brush.TextSecondary}"
                                       VerticalAlignment="Center"
                                       Margin="8,0,4,0"
                                       Visibility="Collapsed"/>
                        </Grid>
                    </Border>
                    <!-- 子菜单Popup -->
                    <Popup x:Name="PART_Popup"
                          AllowsTransparency="True"
                          Focusable="False"
                          IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                          Placement="Right"
                          PlacementTarget="{Binding ElementName=Border}"
                          PopupAnimation="Fade">
                        <Border x:Name="SubmenuBorder"
                                Background="{DynamicResource Brush.MenuBackground}"
                                BorderBrush="{DynamicResource Brush.MenuBorder}"
                                BorderThickness="1"
                                Padding="1">
                            <ScrollViewer x:Name="SubmenuScrollViewer"
                                        CanContentScroll="True"
                                        Background="{DynamicResource Brush.MenuBackground}">
                                <ItemsPresenter x:Name="ItemsPresenter"
                                              KeyboardNavigation.DirectionalNavigation="Cycle"
                                              Grid.IsSharedSizeScope="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsHighlighted" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.MenuItemHover}"/>
                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </Trigger>
                    <Trigger Property="IsSubmenuOpen" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.MenuItemPressed}"/>
                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </Trigger>
                    <!-- 子菜单（Role=SubmenuItem）向右弹出 -->
                    <Trigger Property="Role" Value="SubmenuItem">
                        <Setter TargetName="PART_Popup" Property="Placement" Value="Right"/>
                    </Trigger>
                    <!-- 子菜单项有子项时显示箭头 -->
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="HasItems" Value="True"/>
                            <Condition Property="Role" Value="SubmenuItem"/>
                        </MultiTrigger.Conditions>
                        <Setter TargetName="ArrowPanel" Property="Visibility" Value="Visible"/>
                        <Setter TargetName="ArrowPanel" Property="Foreground" Value="{DynamicResource Brush.AccentPrimary}"/>
                    </MultiTrigger>
                    <!-- 子菜单项悬停时箭头颜色更明显 -->
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="HasItems" Value="True"/>
                            <Condition Property="Role" Value="SubmenuItem"/>
                            <Condition Property="IsHighlighted" Value="True"/>
                        </MultiTrigger.Conditions>
                        <Setter TargetName="ArrowPanel" Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </MultiTrigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Opacity" Value="0.5"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>

            <!-- 顶部主菜单模板 -->
            <ControlTemplate x:Key="MenuItemTopLevelTemplate" TargetType="MenuItem">
                <Grid>
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="True">
                        <ContentPresenter ContentSource="Header"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="True"/>
                    </Border>
                    <Popup x:Name="PART_Popup"
                          AllowsTransparency="True"
                          Focusable="False"
                          IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                          Placement="Bottom"
                          PlacementTarget="{Binding ElementName=Border}"
                          PopupAnimation="Fade">
                        <Border Background="{DynamicResource Brush.MenuBackground}"
                                BorderBrush="{DynamicResource Brush.MenuBorder}"
                                BorderThickness="1"
                                Padding="1">
                            <ScrollViewer CanContentScroll="True"
                                        Background="{DynamicResource Brush.MenuBackground}">
                                <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Cycle"
                                                Grid.IsSharedSizeScope="True"
                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsHighlighted" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.MenuItemHover}"/>
                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </Trigger>
                    <Trigger Property="IsSubmenuOpen" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.MenuItemPressed}"/>
                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Opacity" Value="0.5"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Style.Resources>
        <Setter Property="Padding" Value="10,4"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.MenuForeground}"/>
        <Setter Property="Template" Value="{StaticResource MenuItemDefaultTemplate}"/>
        <Style.Triggers>
            <!-- 主菜单项（Role=TopLevelHeader）使用专用模板，并减小左右内边距 -->
            <Trigger Property="Role" Value="TopLevelHeader">
                <Setter Property="Template" Value="{StaticResource MenuItemTopLevelTemplate}"/>
                <Setter Property="Padding" Value="6,4"/>
            </Trigger>
            <Trigger Property="IsHighlighted" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.MenuItemHover}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            </Trigger>
            <Trigger Property="IsSubmenuOpen" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.MenuItemPressed}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style TargetType="ContextMenu">
        <Setter Property="Background" Value="{DynamicResource Brush.MenuBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.MenuBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.MenuForeground}"/>
        <Setter Property="Padding" Value="4"/>
    </Style>

    <!-- MenuItem的子菜单Border - 全局样式 -->
    <!-- 注意：MenuItem的子菜单通过Popup和Border实现，这里设置全局Border样式 -->
    <Style TargetType="Border" x:Key="MenuItemSubmenuBorder">
        <Setter Property="Background" Value="{DynamicResource Brush.MenuBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.MenuBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- ScrollViewer -->
    <Style TargetType="ScrollViewer">
        <Setter Property="Background" Value="{DynamicResource Brush.ScrollAreaBackground}"/>
    </Style>

    <!-- GroupBox -->
    <Style TargetType="GroupBox">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.PanelBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="8"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>

    <!-- TabItem -->
    <Style TargetType="TabItem">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextSecondary}"/>
        <Setter Property="Background" Value="{DynamicResource Brush.PanelAltBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.PanelBorder}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="TabItem">
                    <Border Name="Border" 
                            Background="{DynamicResource Brush.PanelAltBackground}" 
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter ContentSource="Header" 
                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                        TextElement.Foreground="{DynamicResource Brush.TextSecondary}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.PanelBackground}"/>
                            <Setter TargetName="Border" Property="BorderThickness" Value="3,0,0,0"/>
                            <Setter TargetName="Border" Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
                            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{DynamicResource Brush.ListItemHover}"/>
                            <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                <Setter Property="Background" Value="{DynamicResource Brush.PanelBackground}"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="BorderThickness" Value="3,0,0,0"/>
                <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPrimary}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.ListItemHover}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- TabControl -->
    <Style TargetType="TabControl">
        <Setter Property="Background" Value="{DynamicResource Brush.PanelBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.PanelBorder}"/>
    </Style>

    <!-- ListView -->
    <Style TargetType="ListView">
        <Setter Property="Background" Value="{DynamicResource Brush.PanelBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.PanelBorder}"/>
        <Style.Resources>
            <!-- ListView列头 -->
            <Style TargetType="GridViewColumnHeader">
                <Setter Property="Background" Value="{DynamicResource Brush.PanelAltBackground}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource Brush.PanelBorder}"/>
                <Setter Property="BorderThickness" Value="0,0,1,2"/>
                <Setter Property="Padding" Value="8,6"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{DynamicResource Brush.ListItemHover}"/>
                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Background" Value="{DynamicResource Brush.ListItemSelected}"/>
                        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Style.Resources>
    </Style>

    <!-- ListViewItem -->
    <Style TargetType="ListViewItem">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Setter Property="Background" Value="Transparent"/>
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.ListItemSelected}"/>
                <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource Brush.ListItemHover}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- Separator -->
    <Style TargetType="Separator">
        <Setter Property="Background" Value="{DynamicResource Brush.PanelBorder}"/>
    </Style>

    <!-- RadioButton -->
    <Style TargetType="RadioButton">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- CheckBox -->
    <Style TargetType="CheckBox">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
        <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- Label -->
    <Style TargetType="Label">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
    </Style>

    <!-- TextBlock (默认样式，可被显式设置覆盖) -->
    <Style TargetType="TextBlock">
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
    </Style>

    <!-- ToolTip -->
    <Style TargetType="ToolTip">
        <Setter Property="Background" Value="{DynamicResource Brush.MenuBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource Brush.MenuForeground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.MenuBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="8,4"/>
        <Setter Property="FontSize" Value="12"/>
    </Style>
</ResourceDictionary>

